## OpenStackの機能
* OpenStackはIaaSを提供する
  * Infrastrucre as a Service
  * IaaSのユーザは、WebコンソールやAPIを利用して、さまざまなコンピューティングリソースをクラウド環境に用意できる。
* OpenStackにおいて、中核となる３つのリソースは以下の通り。
  * 仮想ネットワーク
  * 仮想マシンインスタンス
  * ブロックボリューム
* 各ユーザは特定の「プロジェクト」に所属する。1人のユーザは複数のプロジェクトに所属することもある。
* プロジェクトごとにリソースを共有する

### 仮想ネットワーク
* プロジェクトごとにネットワークが独立している
* 仮想ルータを通して、外部ネットワークに接続する
* ネットワークの3つの要素は以下の通り。
  * 仮想スイッチ
  * フローティングIP
  * セキュリティグループ

#### 仮想スイッチ
* 仮想ルータに仮想スイッチが接続する。数は問わない。
* 仮想スイッチが１つのネットワークセグメント(サブネット)に対応する
* 仮想マシンインスタンスはDHCPで自動的にプライベートIPアドレスが割り当てられる
* 同一のプロジェクトに属する仮想マシンインスタンスはプライベートIPアドレスで通信できる
* 異なるプロジェクトに属する場合は、仮想ルータを通して通信する

#### フローティングIP
* フローティングIP = 外部ネットワークから接続可能なパブリックIPアドレス
* 仮想マシンインスタンスから外部ネットワークに接続する場合は、フローティングIPは使用せず、IPマスカレードによって通信する。
  * 家庭内で、ブロードバンドルータを用いてインターネットに接続するのと同じこと

#### セキュリティグループ
* 仮想マシンが受信するパケットは「セキュリティグループ」により、フィルタリングされる
* プライベートIPアドレスによる通信でもフィルタリングされる
* セキュリティグループを作成し、以下の項目によって受信するパケットを決められる。
  * 接続元のIPアドレス
  * 接続先のプロトコル
  * ボート番号
  * 送信元のセキュリティグループ
* 何も設定しなければ、すべて禁止

### 仮想マシンインスタンス
* = クラウド環境で起動する仮想マシンのこと

#### 仮想マシンインスタンスのサイズ
* 事前に「インスタンスタイプ」を定義する。以下のような定義項目がある。
  * 仮想マシンに割り当てられる仮想CPUの個数
  * メモリ容量
  * ルートディスクのサイズ
    * ルートディスク=起動するゲストOSなどが保存されているディスク
    * ルートディスクはテンプレートイメージから作成される
    * ルートディスク以外に、一時ディスクやスワップディスクを設定することができる
    * ルートディスクは仮想マシンが破棄されると、削除される

#### テンプレートイメージ
  * = ゲストOSがインストールされた仮想ディスクイメージ
  * ___heatコンポーネントを使うと作成できる？___

#### スナップショット
  * 起動中の仮想マシンのルートディスクの複製
  * 取得したスナップショットから仮想マシンインスタンスを起動できる。それによって、カスタマイズした状態のゲストOSが使用可能。

#### 接続する仮想ネットワーク
* ここでの仮想ネットワークは仮想スイッチに対応する
* 仮想マシンインスタンスに最低１つは仮想スイッチを設定する
* 仮想マシンインスタンスに複数の仮想スイッチを設定する場合、複数のNICを持つことになる
* テンプレートイメージないのゲストOSでは、それぞれの仮想NICについて、DHCPでIPアドレスを割り当てる設定を事前に行う必要がある。


#### セキュリティグループ
* 仮想マシンインスタンスに受信を許可するネットワークパケットを指定する
* １つの仮想マシンインスタンスに対して複数のセキュリティグループを適応できる

#### キーペア
* 仮想マシンインスタンスのゲストOSにログインする際は、公開鍵認証によるSSH接続を利用する
* 仮想マシンインスタンスを起動する際に、事前に登録していいた公開鍵の１つを指定すると、ゲストOSに指定の公開鍵が埋め込まれて、対応する秘密鍵でSSHログインできるようになる

#### ブロックボリューム
* データ領域に相当する仮想ディスクイメージ
* 仮想マシンインスタンスを削除しても削除されない(ルートディスクとは対照的)
* 他の仮想マシンインスタンスから参照可能
* 同時接続は不可
* ブロックボリュームのスナップショット作成することができる = スナップショット作成して、複製することができる
* 例外的な使い方:ブロックボリュームにゲストOSをインストールすることで、ルートディスクを使用せずにブロックボリュームから仮想マシンインスタンスを起動することができる。
  * 仮想マシンインスタンスを削除しても、ブロックボリュームは残り、再び新たな仮想マシンインタンスを起動することが起動できる

### プロジェクトの管理機能
* 一般ユーザと管理ユーザに別れる
  * 管理ユーザは新規にプロジェクト作成・プロジェクト単位の管理機能の使用ができる
  * プロジェクト単位の管理機能は以下
    * プロジェクト/ユーザ登録管理
      * 新規にプロジェクト作成 + プロジェクト所属のユーザを登録・削除
    * リソース使用レポート
      * プロジェクト全体の仮想CPU数とブロックボリュー容量の総量(仮想ＣＰＵ*時間、ブロックボリューム*時間で計算される積算量)
      * 一般ユーザは、所属プロジェクトのレポートのみを閲覧出来る
    * インスタンスタイプのカスタマイズ
      * インスタンスタイプ設定項目数は以下のとおり
        * 仮想CPU数
        * メモリ容量
        * ルートディスク容量
        * 一時ディスク容量  : 仮想マシンインスタンス破棄時に一緒に破棄される
        * スワップディスク容量 : スワップ領域
    * クォータの設定
      * クォータ : プロジェクト毎に利用できるリソース上限
      * 設定項目は以下のとおり
        * 仮想マシンインスタンス総数
        * 仮想CPU数
        * メモリ総数
        * ブロックボリュームの個数
        * ブロックボリュームの総容量
        * セキュリティグループの総数
        * セキュリティグループあたりのルール数





---
